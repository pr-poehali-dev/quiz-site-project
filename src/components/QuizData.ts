import { QuestionType } from './QuizQuestion';

export const quizQuestions: QuestionType[] = [
  {
    id: 1,
    text: "Как правильно войти в комнату проживающего?",
    options: [
      "Войти без стука, если дверь открыта",
      "Постучать 3 раза, назвать должность/цель, дождаться ответа",
      "Громко постучать один раз и сразу войти", 
      "Использовать мастер-ключ без предупреждения"
    ],
    correctAnswer: 1
  },
  {
    id: 2,
    text: "Как долго хранятся забытые вещи проживающих?",
    options: [
      "7 дней",
      "14 дней", 
      "30 дней",
      "60 дней"
    ],
    correctAnswer: 2
  },
  {
    id: 3,
    text: "Что нужно делать при обнаружении ценных забытых вещей?",
    options: [
      "Оставить на месте до возвращения владельца",
      "Забрать себе, если владелец не объявится в течение недели",
      "Составить акт и передать в сейф или камеру хранения",
      "Выбросить, если вещь выглядит старой"
    ],
    correctAnswer: 2
  },
  {
    id: 4,
    text: "Как часто должен проводиться анализ качества телефонных обращений?",
    options: [
      "Еженедельно",
      "Ежемесячно",
      "Ежеквартально",
      "Ежегодно"
    ],
    correctAnswer: 1
  },
  {
    id: 5,
    text: "Какие принципы являются ключевыми при коммуникации с гостями?",
    options: [
      "Быстрота обслуживания и минимум вопросов",
      "Вежливость, внимание и соблюдение стандартов",
      "Минимальное общение и формальный подход",
      "Строгость и требовательность к гостям"
    ],
    correctAnswer: 1
  },
  {
    id: 6,
    text: "Как быстро необходимо ответить на телефонный звонок?",
    options: [
      "После первого гудка",
      "В течение 3 гудков",
      "В течение 5 гудков",
      "Когда будет удобно сотруднику"
    ],
    correctAnswer: 1
  },
  {
    id: 7,
    text: "Что необходимо делать при приемке и выдаче белья?",
    options: [
      "Просто отдать белье без документации",
      "Проверить комплектацию, зафиксировать в журнале и получить подпись проживающего",
      "Выдавать белье только по предварительной заявке",
      "Выдавать белье только раз в месяц в определенный день"
    ],
    correctAnswer: 1
  },
  {
    id: 8,
    text: "Что нужно сделать с подозрительными забытыми вещами?",
    options: [
      "Выбросить немедленно",
      "Оставить на месте обнаружения",
      "Передать в управление режима",
      "Хранить отдельно от других вещей"
    ],
    correctAnswer: 2
  },
  {
    id: 9,
    text: "Как часто должны актуализироваться стандарты обслуживания?",
    options: [
      "Каждый месяц",
      "Каждые 3-12 месяцев",
      "Один раз в 2 года",
      "Только при смене руководства"
    ],
    correctAnswer: 1
  },
  {
    id: 10,
    text: "Что НЕ рекомендуется делать во время телефонного разговора с гостем?",
    options: [
      "Называть гостя по имени",
      "Жевать, зевать или пить",
      "Уточнять детали обращения",
      "Предлагать альтернативные решения"
    ],
    correctAnswer: 1
  },
  {
    id: 11,
    text: "Какие действия нужно предпринять, если гость не отвечает после стука в дверь?",
    options: [
      "Открыть дверь ключом и войти",
      "Уйти и больше не возвращаться",
      "Приоткрыть дверь и предложить вернуться позже",
      "Громко постучать еще раз"
    ],
    correctAnswer: 2
  },
  {
    id: 12,
    text: "Что является важной частью приветствия гостя?",
    options: [
      "Сообщение о погоде",
      "Визуальный контакт и улыбка",
      "Рассказ о своей должности",
      "Перечисление правил общежития"
    ],
    correctAnswer: 1
  }
];

export const getQuizResults = (answers: number[], userName: string) => {
  if (!answers.length) return { score: 0, message: "Вы не ответили ни на один вопрос.", userName };
  
  let correctCount = 0;
  
  // Проверим только те ответы, для которых у нас есть вопросы
  answers.forEach((answer, index) => {
    if (index < quizQuestions.length && answer === quizQuestions[index].correctAnswer) {
      correctCount++;
    }
  });
  
  // Используем минимальное значение между количеством ответов и количеством вопросов
  const totalAnswered = Math.min(answers.length, quizQuestions.length);
  const score = totalAnswered > 0 ? Math.round((correctCount / totalAnswered) * 100) : 0;
  
  let message = "";
  if (score >= 80) {
    message = `${userName}, отлично! Вы хорошо знаете стандарты обслуживания в общежитиях Президентской академии. Мы будем рады видеть вас в нашей команде!`;
  } else if (score >= 60) {
    message = `${userName}, хороший результат! Вы знакомы с основными принципами коммуникации с гостями, но есть моменты, которые стоит повторить.`;
  } else if (score >= 40) {
    message = `${userName}, неплохо, но вам стоит лучше изучить стандарты обслуживания в общежитиях Президентской академии.`;
  } else {
    message = `${userName}, вам необходимо более детально ознакомиться со стандартами обслуживания. Предлагаем пройти обучение по коммуникации с гостями.`;
  }
  
  return { score, message, correctCount, totalQuestions: totalAnswered, userName };
};
